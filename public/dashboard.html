<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="theme-color" content="#667eea">
    <title>–°–∏—Å—Ç–µ–º–∞ –∞–Ω–∞–ª–∏–∑–∞ –ø—Ä–æ–¥–∞–∂ v5.0</title>
    <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="stylesheet" href="css/styles.css">
</head>
<body>
    <!-- –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä -->
    <div class="container">
        <!-- –®–∞–ø–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è -->
        <div class="app-header">
            <div class="app-title">
                <span>üìä</span>
                <span>–°–∏—Å—Ç–µ–º–∞ –∞–Ω–∞–ª–∏–∑–∞ –ø—Ä–æ–¥–∞–∂ v5.0</span>
            </div>
            <div class="app-controls">
                <div class="user-info">
                    <span class="user-avatar">üë§</span>
                    <div class="user-details">
                        <span class="user-name" id="userName">–ó–∞–≥—Ä—É–∑–∫–∞...</span>
                        <span class="user-role" id="userRole">...</span>
                        <span class="user-role-badge" id="roleBadge"></span>
                    </div>
                </div>
                <button class="btn btn-secondary admin-only" onclick="clearDatabase()" id="clearBtn">
                    <span>üóëÔ∏è</span>
                    <span>–û—á–∏—Å—Ç–∏—Ç—å –ë–î</span>
                </button>
                <button class="btn btn-secondary" onclick="exportDatabase()" id="exportBtn">
                    <span>üíæ</span>
                    <span>–≠–∫—Å–ø–æ—Ä—Ç</span>
                </button>
                <div class="theme-toggle" onclick="toggleTheme()" title="–ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å —Ç–µ–º—É"></div>
                <button class="btn btn-logout" onclick="logout()">–í—ã–π—Ç–∏</button>
            </div>
        </div>
        
        <!-- –ü–∞–Ω–µ–ª—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ -->
        <div class="stats-panel" id="statsPanel">
            <div class="stat-card" onclick="showGlobalDetails('ALL')">
                <div class="stat-icon" style="background: linear-gradient(135deg, #667eea20, #764ba220);">üí∞</div>
                <div class="stat-value" id="statTotal">0</div>
                <div class="stat-label">–û–±—â–∞—è –≤—ã—Ä—É—á–∫–∞</div>
                <div class="stat-change positive hidden" id="statTotalChange">+0%</div>
            </div>
            <div class="stat-card" onclick="showGlobalDetails('CASH')">
                <div class="stat-icon" style="background: #10b98120;">üíµ</div>
                <div class="stat-value" id="statCash">0</div>
                <div class="stat-label">–ù–∞–ª–∏—á–Ω—ã–µ</div>
            </div>
            <div class="stat-card" onclick="showGlobalDetails('QR')">
                <div class="stat-icon" style="background: #3b82f620;">üì±</div>
                <div class="stat-value" id="statQR">0</div>
                <div class="stat-label">QR –ø–ª–∞—Ç–µ–∂–∏</div>
            </div>
            <div class="stat-card" onclick="showGlobalDetails('VIP')">
                <div class="stat-icon" style="background: #f59e0b20;">‚≠ê</div>
                <div class="stat-value" id="statVIP">0</div>
                <div class="stat-label">VIP –∫–ª–∏–µ–Ω—Ç—ã</div>
            </div>
            <div class="stat-card" onclick="showGlobalDetails('CARD')">
                <div class="stat-icon" style="background: #8b5cf620;">üí≥</div>
                <div class="stat-value" id="statCard">0</div>
                <div class="stat-label">–ö–∞—Ä—Ç—ã</div>
            </div>
            <div class="stat-card negative" onclick="showGlobalDetails('RETURN')">
                <div class="stat-icon" style="background: #ef444420;">‚Ü©Ô∏è</div>
                <div class="stat-value return-value" id="statReturn">0</div>
                <div class="stat-label">–í–æ–∑–≤—Ä–∞—Ç—ã</div>
            </div>
        </div>
        
        <!-- –ó–æ–Ω–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Ñ–∞–π–ª–∞ (—Ç–æ–ª—å–∫–æ –¥–ª—è –∞–¥–º–∏–Ω–∞) -->
        <div class="upload-zone admin-only" id="uploadZone">
            <div class="upload-area" id="uploadArea">
                <div class="upload-icon">üìÅ</div>
                <div class="upload-title">–ó–∞–≥—Ä—É–∑–∏—Ç–µ —Ñ–∞–π–ª Excel</div>
                <div class="upload-subtitle">–ü–µ—Ä–µ—Ç–∞—â–∏—Ç–µ —Ñ–∞–π–ª —Å—é–¥–∞ –∏–ª–∏ –Ω–∞–∂–º–∏—Ç–µ –¥–ª—è –≤—ã–±–æ—Ä–∞</div>
                <input type="file" id="fileInput" accept=".xlsx,.xls" hidden>
                <button class="btn btn-primary" onclick="document.getElementById('fileInput').click()">
                    –í—ã–±—Ä–∞—Ç—å —Ñ–∞–π–ª
                </button>
                <div style="margin-top: 16px; opacity: 0.7; font-size: 14px;">
                    –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç—Å—è —Ñ–æ—Ä–º–∞—Ç—ã Excel (.xlsx, .xls) –¥–æ 50MB
                </div>
            </div>
        </div>
        
        <!-- –¢–∞–±—ã -->
        <div class="tabs-container" id="tabsContainer">
            <button class="tab-btn active" onclick="switchTab('table')">
                üìã –¢–∞–±–ª–∏—Ü–∞
            </button>
            <button class="tab-btn" onclick="switchTab('charts')">
                üìà –ì—Ä–∞—Ñ–∏–∫–∏
            </button>
            <button class="tab-btn" onclick="switchTab('products')">
                üì¶ –¢–æ–≤–∞—Ä—ã
            </button>
            <button class="tab-btn admin-only" onclick="switchTab('database')">
                üóÑÔ∏è –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
            </button>
        </div>
        
        <!-- –ö–æ–Ω—Ç–µ–Ω—Ç –≤–∫–ª–∞–¥–∫–∏ –¢–∞–±–ª–∏—Ü–∞ -->
        <div class="tab-content active" id="tableTab">
            <div class="table-container">
                <div class="table-header">
                    <div>
                        <h3>–î–∞–Ω–Ω—ã–µ –ø–æ –ø–µ—Ä–∏–æ–¥–∞–º</h3>
                    </div>
                    <div class="table-controls">
                        <input type="text" class="search-input" placeholder="–ü–æ–∏—Å–∫..." id="tableSearch">
                        <button class="btn btn-secondary" onclick="selectAllPeriods()">–í—ã–±—Ä–∞—Ç—å –≤—Å–µ</button>
                        <button class="btn btn-secondary" onclick="deselectAllPeriods()">–°–Ω—è—Ç—å –≤—ã–¥–µ–ª–µ–Ω–∏–µ</button>
                        <button class="btn btn-secondary" onclick="expandAll()">–†–∞–∑–≤–µ—Ä–Ω—É—Ç—å</button>
                        <button class="btn btn-secondary" onclick="collapseAll()">–°–≤–µ—Ä–Ω—É—Ç—å</button>
                    </div>
                </div>
                <div style="overflow-x: auto;">
                    <table>
                        <thead>
                            <tr>
                                <th width="40">‚úì</th>
                                <th width="40"></th>
                                <th>–ü–µ—Ä–∏–æ–¥</th>
                                <th class="text-center" colspan="2">–ù–∞–ª–∏—á–Ω—ã–µ</th>
                                <th class="text-center" colspan="2">QR</th>
                                <th class="text-center" colspan="2">VIP</th>
                                <th class="text-center" colspan="2">–ö–∞—Ä—Ç—ã</th>
                                <th class="text-center" colspan="2">–í–æ–∑–≤—Ä–∞—Ç—ã</th>
                                <th class="text-center" colspan="2" style="background: linear-gradient(135deg, #667eea, #764ba2); color: white;">–ò—Ç–æ–≥–æ</th>
                            </tr>
                            <tr>
                                <th></th>
                                <th></th>
                                <th></th>
                                <th class="text-right">–ö–æ–ª-–≤–æ</th>
                                <th class="text-right">–°—É–º–º–∞</th>
                                <th class="text-right">–ö–æ–ª-–≤–æ</th>
                                <th class="text-right">–°—É–º–º–∞</th>
                                <th class="text-right">–ö–æ–ª-–≤–æ</th>
                                <th class="text-right">–°—É–º–º–∞</th>
                                <th class="text-right">–ö–æ–ª-–≤–æ</th>
                                <th class="text-right">–°—É–º–º–∞</th>
                                <th class="text-right">–ö–æ–ª-–≤–æ</th>
                                <th class="text-right return-value">–°—É–º–º–∞</th>
                                <th class="text-right" style="background: linear-gradient(135deg, #667eea, #764ba2); color: white;">–ö–æ–ª-–≤–æ</th>
                                <th class="text-right" style="background: linear-gradient(135deg, #667eea, #764ba2); color: white;">–°—É–º–º–∞</th>
                            </tr>
                        </thead>
                        <tbody id="tableBody">
                            <!-- –î–∞–Ω–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
        
        <!-- –ö–æ–Ω—Ç–µ–Ω—Ç –≤–∫–ª–∞–¥–∫–∏ –ì—Ä–∞—Ñ–∏–∫–∏ -->
        <div class="tab-content" id="chartsTab">
            <div class="charts-grid">
                <div class="chart-card">
                    <div class="chart-header">
                        <h3 class="chart-title">–î–∏–Ω–∞–º–∏–∫–∞ –ø—Ä–æ–¥–∞–∂ –ø–æ –º–µ—Å—è—Ü–∞–º</h3>
                        <button class="btn btn-secondary" onclick="updateCharts()">üîÑ</button>
                    </div>
                    <div class="chart-container">
                        <canvas id="salesTrendChart"></canvas>
                    </div>
                </div>
                <div class="chart-card">
                    <div class="chart-header">
                        <h3 class="chart-title">–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ —Ç–∏–ø–∞–º –æ–ø–ª–∞—Ç—ã</h3>
                    </div>
                    <div class="chart-container">
                        <canvas id="paymentTypesChart"></canvas>
                    </div>
                </div>
                <div class="chart-card">
                    <div class="chart-header">
                        <h3 class="chart-title">–¢–æ–ø-10 —Ç–æ–≤–∞—Ä–æ–≤</h3>
                    </div>
                    <div class="chart-container">
                        <canvas id="topProductsChart"></canvas>
                    </div>
                </div>
                <div class="chart-card">
                    <div class="chart-header">
                        <h3 class="chart-title">–°—Ä–∞–≤–Ω–µ–Ω–∏–µ –ø–µ—Ä–∏–æ–¥–æ–≤</h3>
                    </div>
                    <div class="chart-container">
                        <canvas id="periodComparisonChart"></canvas>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- –ö–æ–Ω—Ç–µ–Ω—Ç –≤–∫–ª–∞–¥–∫–∏ –¢–æ–≤–∞—Ä—ã -->
        <div class="tab-content" id="productsTab">
            <div class="table-container">
                <div class="table-header">
                    <div>
                        <h3>–ê–Ω–∞–ª–∏–∑ —Ç–æ–≤–∞—Ä–æ–≤</h3>
                    </div>
                    <div class="table-controls">
                        <input type="text" class="search-input" placeholder="–ü–æ–∏—Å–∫ —Ç–æ–≤–∞—Ä–∞..." id="productSearch">
                        <button class="btn btn-success" onclick="exportProducts()">
                            üì• –≠–∫—Å–ø–æ—Ä—Ç –≤ Excel
                        </button>
                    </div>
                </div>
                <div style="overflow-x: auto;">
                    <table>
                        <thead>
                            <tr>
                                <th>‚Ññ</th>
                                <th>–¢–æ–≤–∞—Ä</th>
                                <th>–í–∞—Ä–∏–∞–Ω—Ç</th>
                                <th class="text-right">–ü—Ä–æ–¥–∞–Ω–æ</th>
                                <th class="text-right">–í–æ–∑–≤—Ä–∞—Ç—ã</th>
                                <th class="text-right">–í—ã—Ä—É—á–∫–∞</th>
                                <th class="text-right">–°—Ä–µ–¥–Ω–∏–π —á–µ–∫</th>
                                <th class="text-right">–î–æ–ª—è</th>
                            </tr>
                        </thead>
                        <tbody id="productsTableBody">
                            <!-- –î–∞–Ω–Ω—ã–µ —Ç–æ–≤–∞—Ä–æ–≤ -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
        
        <!-- –ö–æ–Ω—Ç–µ–Ω—Ç –≤–∫–ª–∞–¥–∫–∏ –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö -->
        <div class="tab-content" id="databaseTab">
            <div class="database-container">
                <div class="db-header">
                    <h2>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö</h2>
                    <div class="db-controls admin-only">
                        <button class="btn btn-danger" onclick="clearDatabase()">–û—á–∏—Å—Ç–∏—Ç—å –ë–î</button>
                        <button class="btn btn-primary" onclick="exportDatabase()">–≠–∫—Å–ø–æ—Ä—Ç –ë–î</button>
                    </div>
                </div>
                <div class="db-stats" id="dbStats"></div>
                <div class="db-content" id="dbContent"></div>
            </div>
        </div>
    </div>
    
    <!-- –ü–∞–Ω–µ–ª—å –∏—Ç–æ–≥–æ–≤ -->
    <div class="summary-panel" id="summaryPanel">
        <div class="summary-content">
            <div style="min-width: 200px;">
                <h4 id="summaryTitle">–í—ã–±–µ—Ä–∏—Ç–µ –ø–µ—Ä–∏–æ–¥—ã</h4>
                <div style="font-size: 12px; opacity: 0.7;" id="summarySubtitle">–¥–ª—è –∞–Ω–∞–ª–∏–∑–∞</div>
            </div>
            <div class="summary-stats" id="summaryStats">
                <!-- –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ -->
            </div>
            <div>
                <button class="btn btn-primary" onclick="compareSelectedPeriods()" id="compareBtn" style="display: none;">
                    üìä –°—Ä–∞–≤–Ω–∏—Ç—å
                </button>
            </div>
        </div>
    </div>
    
    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ -->
    <div class="modal" id="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title" id="modalTitle">–î–µ—Ç–∞–ª–∏–∑–∞—Ü–∏—è</h3>
                <button class="modal-close" onclick="closeModal()">√ó</button>
            </div>
            <div class="modal-body" id="modalBody">
                <!-- –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π –∫–æ–Ω—Ç–µ–Ω—Ç -->
            </div>
        </div>
    </div>
    
    <!-- –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä –∑–∞–≥—Ä—É–∑–∫–∏ -->
    <div class="loading-overlay" id="loadingOverlay">
        <div class="loading-content">
            <div class="loading-spinner"></div>
            <div class="loading-text" id="loadingText">–û–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö...</div>
            <div class="loading-progress" id="loadingProgress">0%</div>
        </div>
    </div>
    
    <!-- –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è -->
    <div class="toast-container" id="toastContainer"></div>

    <script src="js/app.js"></script>
</body>
</html>
